<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>Models of Discrete Time Systems</title>
  <meta name="description" content="clear allcd matlabpwdformat compact">

  <link rel="canonical" href="/eg-247-textbook/eg-247-textbook/dt_systems/4/dt_models.html">
  <link rel="alternate" type="application/rss+xml" title="EG-247 Signals and Systems" href="/eg-247-textbook/eg-247-textbook/feed.xml">

  <meta property="og:url"         content="/eg-247-textbook/eg-247-textbook/dt_systems/4/dt_models.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Models of Discrete Time Systems" />
<meta property="og:description" content="clear allcd matlabpwdformat compact" />
<meta property="og:image"       content="" />


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage":
    "/eg-247-textbook/dt_systems/4/dt_models.html",
  "headline":
    "Models of Discrete Time Systems",
  "datePublished":
    "2019-03-01T15:54:29+00:00",
  "dateModified":
    "2019-03-01T15:54:29+00:00",
  "description":
    "clear allcd matlabpwdformat compact",
  "author": {
    "@type": "Person",
    "name": "Dr Chris P. Jobling"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "/eg-247-textbook",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "/eg-247-textbook",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/eg-247-textbook/assets/css/styles.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css ">
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/eg-247-textbook/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    CommonHTML: {
        linebreaks: {
            automatic: true,
        },
    },
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML' async></script>

  <!-- DOM updating function -->
  <script>
const runWhenDOMLoaded = cb => {
  if (document.readyState != 'loading') {
    cb()
  } else if (document.addEventListener) {
    document.addEventListener('DOMContentLoaded', cb)
  } else {
    document.attachEvent('onreadystatechange', function() {
      if (document.readyState == 'complete') cb()
    })
  }
}

// Helper function to init things quickly
initFunction = function(myfunc) {
  runWhenDOMLoaded(myfunc);
  document.addEventListener('turbolinks:load', myfunc);
};
</script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="/eg-247-textbook/assets/js/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  <script src="https://unpkg.com/nbinteract-core" async></script>

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->


  <!-- Google analytics -->
  <script src="/eg-247-textbook/assets/js/ga.js" async></script>

  <!-- Clipboard copy button -->
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" async></script>

  <!-- Load custom website scripts -->
  <script src="/eg-247-textbook/assets/js/scripts.js" async></script>

  <!-- Load JS that depends on site variables -->
  <script>
/**
 * Set up copy/paste for code blocks
 */
const codeCellId = index => `codecell${index}`

const clipboardButton = id =>
  `<a class="btn copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#${id}">
    <img src="/eg-247-textbook/assets/images/copy-button.svg" alt="Copy to clipboard">
  </a>`

// Clears selected text since ClipboardJS will select the text when copying
const clearSelection = () => {
  if (window.getSelection) {
    window.getSelection().removeAllRanges()
  } else if (document.selection) {
    document.selection.empty()
  }
}

// Changes tooltip text for two seconds, then changes it back
const temporarilyChangeTooltip = (el, newText) => {
  const oldText = el.getAttribute('data-tooltip')
  el.setAttribute('data-tooltip', newText)
  setTimeout(() => el.setAttribute('data-tooltip', oldText), 2000)
}

const addCopyButtonToCodeCells = () => {
  // If ClipboardJS hasn't loaded, wait a bit and try again. This
  // happens because we load ClipboardJS asynchronously.
  if (window.ClipboardJS === undefined) {
    setTimeout(addCopyButtonToCodeCells, 250)
    return
  }

  const codeCells = document.querySelectorAll('.input_area pre')
  codeCells.forEach((codeCell, index) => {
    const id = codeCellId(index)
    codeCell.setAttribute('id', id)
    codeCell.insertAdjacentHTML('afterend', clipboardButton(id))
  })

  const clipboard = new ClipboardJS('.copybtn')
  clipboard.on('success', event => {
    clearSelection()
    temporarilyChangeTooltip(event.trigger, 'Copied!')
  })

  clipboard.on('error', event => {
    temporarilyChangeTooltip(event.trigger, 'Failed to copy')
  })

  // Get rid of clipboard before the next page visit to avoid memory leak
  document.addEventListener('turbolinks:before-visit', () =>
    clipboard.destroy()
  )
}

initFunction(addCopyButtonToCodeCells);
</script>

  <!-- Load custom user CSS and JS  -->
  <script src="/eg-247-textbook/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/eg-247-textbook/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  <script>
/**
  * To auto-embed hub URLs in interact links if given in a RESTful fashion
 */

function getJsonFromUrl(url) {
  var query = url.split('?');
  if (query.length < 2) {
    // No queries so just return false
    return false;
  }
  query = query[1];
  // Collect REST params into a dictionary
  var result = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  });
  return result;
}
    
function dict2param(dict) {
    params = Object.keys(dict).map(function(k) {
        return encodeURIComponent(k) + '=' + encodeURIComponent(dict[k])
    });
    return params.join('&')
}

// Parse a Binder URL, converting it to the string needed for JupyterHub
function binder2Jupyterhub(url) {
  newUrl = {};
  parts = url.split('v2/gh/')[1];
  // Grab the base repo information
  repoinfo = parts.split('?')[0];
  var [org, repo, ref] = repoinfo.split('/');
  newUrl['repo'] = ['https://github.com', org, repo].join('/');
  newUrl['branch'] = ref
  // Grab extra parameters passed
  params = getJsonFromUrl(url);
  if (params['filepath'] !== undefined) {
    newUrl['subPath'] = params['filepath']
  }
  return dict2param(newUrl);
}

// Filter out potentially unsafe characters to prevent xss
function safeUrl(url)
{
   return String(encodeURIComponent(url))
            .replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
}

function addParamToInternalLinks(hub) {
  var links = document.querySelectorAll("a").forEach(function(link) {
    var href = link.href;
    // If the link is an internal link...
    if (href.search("") !== -1 || href.startsWith('/') || href.search("127.0.0.1:") !== -1) {
      // Assume we're an internal link, add the hub param to it
      var params = getJsonFromUrl(href);
      if (params !== false) {
        // We have REST params, so append a new one
        params['hub'] = hub;
      } else {
        // Create the REST params
        params = {'hub': hub};
      }
      // Update the link
      var newHref = href.split('?')[0] + '?' + dict2param(params);
      link.setAttribute('href', decodeURIComponent(newHref));
    }
  });
  return false;
}

// Update interact links
function updateInteractLink() {
    // hack to make this work since it expects a ? in the URL
    rest = getJsonFromUrl("?" + location.search.substr(1));
    hubUrl = rest['hub'];
    if (hubUrl !== undefined) {
      // Sanitize the hubUrl
      hubUrl = safeUrl(hubUrl);
      // Add HTTP text if omitted
      if (hubUrl.indexOf('http') < 0) {hubUrl = 'http://' + hubUrl;}
      link = document.querySelectorAll("a.interact-button")[0];
      if (link !== undefined) {
          // Update the interact link URL
          var href = link.getAttribute('href');
          var hub_type = '';
          if (hub_type === 'binder') {
            // If binder links exist, we need to re-work them for jupyterhub
            if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
              // If localhost, assume we're working from a local Jupyter server and remove `/hub`
              first = [hubUrl, 'git-sync'].join('/')
            } else {
              first = [hubUrl, 'hub', 'user-redirect', 'git-sync'].join('/')
            }
            href = first + '?' + binder2Jupyterhub(href);
          } else {
            // If JupyterHub links, we only need to replace the hub url
            href = href.replace("", hubUrl);
            if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
              // Assume we're working from a local Jupyter server and remove `/hub`
              href = href.replace("/hub/user-redirect", "");
            }
          }
          link.setAttribute('href', decodeURIComponent(href));

          // Add text after interact link saying where we're launching
          hubUrlNoHttp = decodeURIComponent(hubUrl).replace('http://', '').replace('https://', '');
          document.querySelectorAll("a.interact-button")[0].insertAdjacentHTML('afterend', '<div class="interact-context">on ' + hubUrlNoHttp + '</div>');
      }
      // Update internal links so we retain the hub url
      addParamToInternalLinks(hubUrl);
    }
}

runWhenDOMLoaded(updateInteractLink)
document.addEventListener('turbolinks:load', updateInteractLink)
</script>
</head>

  <body>
    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <img src="/eg-247-textbook/images/logo/logo.png" class="textbook_logo" id="sidebar-logo" data-turbolinks-permanent/>
  <h2 class="c-sidebar__title">EG-247 Signals and Systems</h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/introduction/index"
        >
          
            1.
          
          Introduction
        </a>

        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/elementary_signals/index"
        >
          
            2.
          
          Elementary Signals
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/elementary_signals/hw1"
                >
                  
                  Homework 1
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/laplace_transform/index"
        >
          
            3.
          
          Laplace Transforms and their Applications
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/1/laplace"
                >
                  
                    3.1
                  
                  The Laplace Transformation
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/2/inverse_laplace"
                >
                  
                    3.2
                  
                  The Inverse Laplace Transform
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/3/circuit_analysis"
                >
                  
                    3.3
                  
                  Using Laplace Transforms for Circuit Analysis
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/4/transfer_functions"
                >
                  
                    3.4
                  
                  Transfer Functions
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/5/convolution"
                >
                  
                    3.5
                  
                  The Impulse Response and Convolution
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/fourier_series/index"
        >
          
            4.
          
          Fourier Series
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_series/1/trig_fseries"
                >
                  
                    4.1
                  
                  Trigonometric Fourier Series
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_series/2/exp_fs1"
                >
                  
                    4.2
                  
                  Exponential Fourier Series
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_series/3/exp_fs2"
                >
                  
                    4.3
                  
                  Line Spectra and their Applications
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/fourier_transform/index"
        >
          
            5.
          
          Fourier Transform
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_transform/1/ft1"
                >
                  
                    5.1
                  
                  Defining the Fourier Transform
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_transform/2/ft2"
                >
                  
                    5.2
                  
                  Fourier transform of commonly occuring signals
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_transform/3/ft3"
                >
                  
                    5.3
                  
                  Fourier Transforms for Circuit and LTI Systems Analysis
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_transform/4/ft4"
                >
                  
                    5.4
                  
                  Introduction to Filters
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/dt_systems/index"
        >
          
            6.
          
          Sampled Data Systems
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/dt_systems/1/sampling"
                >
                  
                    6.1
                  
                  Sampling Theory
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/dt_systems/2/z_transform"
                >
                  
                    6.2
                  
                  The Z-Transform
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/dt_systems/3/i_z_transform"
                >
                  
                    6.3
                  
                  The Inverse Z-Transform
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry c-sidebar__entry--active"
                  href="/eg-247-textbook/dt_systems/4/dt_models"
                >
                  
                    6.4
                  
                  Models of Discrete Time Systems
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      
        <li><h2 class="c-sidebar__title">In Class Worksheets</li>
        
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/worksheets/index"
        >
          
          Worksheets
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/introduction/worksheet1"
                >
                  
                  Worksheet 1 Introduction
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/introduction/worksheet2"
                >
                  
                  Worksheet 2
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/elementary_signals/worksheet3"
                >
                  
                  Worksheet 3 Elementary Signals
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/1/worksheet4"
                >
                  
                  Worksheet 4 Laplace Transform
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/2/worksheet5"
                >
                  
                  Worksheet 5 Inverse Laplace Transform
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/3/worksheet6"
                >
                  
                  Worksheet 6 Using Laplace Transforms for Circuit Analysis
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/4/worksheet7"
                >
                  
                  Worksheet 7 Transfer Functions
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/5/worksheet8"
                >
                  
                  Worksheet 8 Impulse Response and Time Convolution
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_series/1/worksheet9"
                >
                  
                  Worksheet 9 Trigonometric Fourier Series
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_series/2/worksheet10"
                >
                  
                  Worksheet 10 Exponential Fourier Series
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_series/3/worksheet11"
                >
                  
                  Worksheet 11 Line Spectra and their Applications
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      
        <li><h2 class="c-sidebar__title">Homework</li>
        
      
      
        <li class="c-sidebar__divider"></li>
        
      
      
        <li><h2 class="c-sidebar__title">Lab Exercises</li>
        
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/labs/index"
        >
          
          Laboratory Exercises
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/lab01/index"
                >
                  
                  Lab 1 - Elemementary Signals
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/lab02/index"
                >
                  
                  Lab 2 - Laplace and Inverse Laplace Transforms
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/lab03/index"
                >
                  
                  Lab 3 -  Laplace Transforms and Transfer Functions for Circuit Analysis
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/lab04/index"
                >
                  
                  Lab 4 - Time Domain Convolution
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/lab05/index"
                >
                  
                  Lab 5 - Fourier Series
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/lab06/index"
                >
                  
                  Lab 6 - Sounds and Sampling
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/lab07/index"
                >
                  
                  Optional Lab 7 - Filters
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/project/index"
                >
                  
                  Project
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      
        <li><h2 class="c-sidebar__title">Project</li>
        
      
      
        <li class="c-sidebar__divider"></li>
        
      
      
        <li><h2 class="c-sidebar__title">Answers to Selected problems</li>
        
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/introduction/answers"
        >
          
          Worksheet 2
        </a>

        
      </li>

      
    
  </ul>
  <p class="sidebar_footer">Powered by <a href="https://github.com/choldgraf/jupyter-book">Jupyter Book</a></p>
</nav>

      <!-- Shamelessly copied from minimal mistakes -->


<!-- TOC will only show up if it has at least one item -->


  <aside class="sidebar__right">
    <nav class="onthispage">
      <header><h4 class="nav__title"><i class="fa fa-list"></i>   On this page</h4></header>
      <ul class="toc__menu">
  <li><a href="#scope-and-background-reading">Scope and Background Reading</a></li>
  <li><a href="#agenda">Agenda</a></li>
  <li><a href="#discrete-time-systems">Discrete Time Systems</a>
    <ul>
      <li><a href="#dt-system-as-a-sequence-processor">DT System as a Sequence Processor</a></li>
      <li><a href="#what-is-the-nature-of-the-dts">What is the nature of the DTS?</a></li>
    </ul>
  </li>
  <li><a href="#transfer-functions-in-the-z-domain">Transfer Functions in the Z-Domain</a>
    <ul>
      <li><a href="#take-z-transform-of-both-sides">Take Z-Transform of both sides</a></li>
      <li><a href="#gather-terms">Gather terms</a></li>
      <li><a href="#define-transfer-function">Define transfer function</a></li>
      <li><a href="#dt-impulse-response">DT impulse response</a></li>
      <li><a href="#example-5">Example 5</a></li>
      <li><a href="#51-the-transfer-function">5.1. The transfer function</a></li>
      <li><a href="#52-the-dt-impulse-response">5.2. The DT impulse response</a></li>
      <li><a href="#matlab-solution">Matlab Solution</a></li>
      <li><a href="#53-the-dt-step-response">5.3. The DT step response</a></li>
      <li><a href="#matlab-solution-1">Matlab Solution</a></li>
      <li><a href="#results">Results</a></li>
    </ul>
  </li>
  <li><a href="#modelling-dt-systems-in-matlab-and-simulink">Modelling DT systems in Matlab and Simulink</a>
    <ul>
      <li><a href="#matlab">Matlab</a></li>
      <li><a href="#simulink-model">Simulink Model</a></li>
    </ul>
  </li>
  <li><a href="#converting-continuous-time-systems-to-discrete-time-systems">Converting Continuous Time Systems to Discrete Time Systems</a>
    <ul>
      <li><a href="#continuous-system-equivalents">Continuous System Equivalents</a></li>
      <li><a href="#matlab-c2d-function">Matlab c2d function</a></li>
      <li><a href="#example-6">Example 6</a></li>
      <li><a href="#solution">Solution</a></li>
      <li><a href="#bode-plot">Bode plot</a></li>
      <li><a href="#sampling-frequency">Sampling Frequency</a></li>
      <li><a href="#digital-butterworth">Digital Butterworth</a></li>
      <li><a href="#step-response">Step response</a></li>
      <li><a href="#algorithm">Algorithm</a></li>
      <li><a href="#convert-to-code">Convert to code</a></li>
      <li><a href="#comments">Comments</a></li>
    </ul>
  </li>
  <li><a href="#summary">Summary</a></li>
  <li><a href="#solutions-to-example-5">Solutions to Example 5</a>
    <ul>
      <li><a href="#solution-to-51">Solution to 5.1.</a></li>
      <li><a href="#solution-to-52">Solution to 5.2.</a></li>
      <li><a href="#solution-to-53">Solution to 5.3.</a></li>
    </ul>
  </li>
</ul>
    </nav>
  </aside>



      <main class="c-textbook__page" tabindex="-1">
          <div class="o-wrapper">
            <div class="c-sidebar-toggle">
  <!-- We show the sidebar by default so we use .is-active -->
  <button
    id="js-sidebar-toggle"
    class="hamburger hamburger--arrowalt is-active"
  >
    <span class="hamburger-box">
      <span class="hamburger-inner"></span>
    </span>
    <span class="c-sidebar-toggle__label">Toggle Sidebar</span>
  </button>
</div>

            
<div class="buttons">




</div>


            <div class="c-textbook__content">
              <div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">clear</span> <span class="nb">all</span>
<span class="nb">cd</span> <span class="n">matlab</span>
<span class="nb">pwd</span>
<span class="nb">format</span> <span class="n">compact</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
ans =

    '/Users/eechris/dev/eg-247-textbook/content/dt_systems/4/matlab'


</code></pre></div></div>

<h1 id="models-of-discrete-time-systems">Models of Discrete-Time Systems</h1>

<h2 id="scope-and-background-reading">Scope and Background Reading</h2>

<p>This we will explore digital systems and learn more about the z-transfer function model.</p>

<p>The material in this presentation and notes is based on Chapter 9 (Starting at Section 9.7) of <a href="http://site.ebrary.com/lib/swansea/docDetail.action?docID=10547416">Steven T. Karris, Signals and Systems: with Matlab Computation and Simulink Modelling, 5th Edition.</a> from the <strong>Required Reading List</strong>. I have skipped the section on digital state-space models.</p>

<h2 id="agenda">Agenda</h2>

<ul>
  <li>
    <p>Discrete Time Systems</p>
  </li>
  <li>
    <p>Transfer Functions in the Z-Domain</p>
  </li>
  <li>
    <p>Modelling digital systems in Matlab/Simulink</p>
  </li>
  <li>
    <p>Continuous System Equivalents</p>
  </li>
  <li>
    <p>Example: Digital Butterworth Filter</p>
  </li>
</ul>

<h2 id="discrete-time-systems">Discrete Time Systems</h2>

<p>In the lecture that introduced the z-transform we talked about the representation of a discrete-time (DT) system by the model shown below:</p>

<p><img src="pictures/ct-to-dt.png" /></p>

<p>In this session, we want to explore the contents of the central block.</p>

<h3 id="dt-system-as-a-sequence-processor">DT System as a Sequence Processor</h3>

<ul>
  <li>
    <p>As noted in the previous slide, the discrete time system (DTS) `takes as an input the sequence $x_d[n]$<sup>1</sup> which in a physical signal would be obtained by sampling the continuous time signal $x(t)$ using an analogue to digital converter (ADC).</p>
  </li>
  <li>
    <p>It produces another sequence $y_d[n]$ by <em>processing</em> the input sequence in some way.</p>
  </li>
  <li>
    <p>The output sequence is converted into an analogue signal $y(t)$ by a digital to analogue converter (DAC).</p>
  </li>
</ul>

<p><img src="pictures/sigs.png" /></p>

<h3 id="what-is-the-nature-of-the-dts">What is the nature of the DTS?</h3>

<ul>
  <li>
    <p>The discrete time system (DTS) is a block that converts a sequence $x_d[n]$ into another sequence $y_d[n]$</p>
  </li>
  <li>
    <p>The transformation will be a <em>difference equation</em> $h[n]$</p>
  </li>
  <li>
    <p>By analogy with CT systems, $h[n]$ is the impulse response of the DTS, and $y[n]$ can be obtained by <em>convolving</em> $h[n]$ with $x_d[n]$ so:</p>
  </li>
</ul>

<script type="math/tex; mode=display">y_d[n] = h[n] * x_d[n]</script>

<ul>
  <li>Taking the z-transform of $h[n]$ we get $H(z)$, and from the transform properties, convolution of the signal $x_d[n]$ by system $h[n]$ will be <em>multiplication</em> of the z-transforms:</li>
</ul>

<script type="math/tex; mode=display">Y_d(z) = H(z) X_d(z)</script>

<ul>
  <li>So, what does $h[n]$ and therefore $H(z)$ look like?</li>
</ul>

<h2 id="transfer-functions-in-the-z-domain">Transfer Functions in the Z-Domain</h2>

<p>Let us assume that the sequence transformation is a <em>difference equation</em> of the form<sup>2</sup>:</p>

<script type="math/tex; mode=display">\begin{array}{l}
y[n] + {a_1}y[n - 1] + {a_2}y[n - 2] +  \cdots  + {a_k}y[n - k]\\
\quad  = {b_0}x[n] + {b_1}u[n - 1] + {b_2}u[n - 2] +  \cdots  + {b_k}u[n - k]
\end{array}</script>

<h3 id="take-z-transform-of-both-sides">Take Z-Transform of both sides</h3>

<p>From the z-transform properties</p>

<script type="math/tex; mode=display">f[n-m] \Leftrightarrow z^{-m}F(z)</script>

<p>so….</p>

<script type="math/tex; mode=display">Y(z) + a_1z^{-1}Y(z) + a_2z^{-2}Y(z) + \cdots + a_kz^{-k}Y(z) = ...</script>

<script type="math/tex; mode=display">b_0 U(z) + b_1z^{-1}U(z) + b_2z^{-2}U(z) + \cdots + b_kz^{-k}U(z)</script>

<h3 id="gather-terms">Gather terms</h3>

<script type="math/tex; mode=display">\begin{array}{l}
\left( 1 + {a_1} z^{-1} + {a_2} z^{-2} +  \cdots {a_k} z^{-k} \right)Y(z) = \\
\quad \left( b_0 + b_1 z^{-1} + b_2 z^{- 2} +  \cdots b_k z^{- k} \right)U(z)
\end{array}</script>

<p>from which …</p>

<script type="math/tex; mode=display">Y(z) = \left(\frac{b_0 + b_{1}z^{-1} + b_{2}z^{-2} + \cdots b_{k}z^{-k}}{1 + a_{1}z^{-1} + a_{2}z^{-2} + \cdots a_{k}z^{-k}
}\right) U(z)</script>

<h3 id="define-transfer-function">Define transfer function</h3>

<p>We define the <em>discrete time transfer function</em> $H(z) := Y(z)/U(z)$ so…</p>

<script type="math/tex; mode=display">H(z) = \frac{Y(z)}{U(z)} = \frac{b_0 + b_{1}z^{-1} + b_{2}z^{-2} + \cdots b_{k}z^{-k}}{1 + a_{1}z^{-1} + a_{2}z^{-2} + \cdots a_{k}z^{-k}
}</script>

<p>… or more conventionally<sup>3</sup>:</p>

<script type="math/tex; mode=display">H(z) = \frac{b_0z^k + b_{1}z^{k-1} + b_{2}z^{k-2} + \cdots b_{k-1}z + b_{k}}{z^k + a_{1}z^{k-1} + a_{2}z^{k-2} + \cdots a_{k-1} z + a_{k}}</script>

<h3 id="dt-impulse-response">DT impulse response</h3>

<p>The <em>discrete-time impulse reponse</em> $h[n]$ is the response of the DT system to the input $x[n] = \delta[n]$</p>

<p>Last week we showed that <script type="math/tex">\mathcal{Z}\left\{\delta[n]\right\}</script> was defined by the transform pair</p>

<script type="math/tex; mode=display">\delta[n] \Leftrightarrow 1</script>

<p>so</p>

<script type="math/tex; mode=display">h[n] = \mathcal{Z}^{-1}\left\{H(z).1\right\} = \mathcal{Z}^{-1}\left\{H(z)\right\}</script>

<h3 id="example-5">Example 5</h3>

<p>Karris Example 9.10:</p>

<p>The difference equation describing the input-output relationship of a DT system with zero initial conditions, is:</p>

<script type="math/tex; mode=display">y[n] - 0.5 y[n-1] + 0.125 y[n-2] = x[n] + x[n -1]</script>

<p>Compute:</p>

<ol>
  <li>The transfer function $H(z)$</li>
  <li>The DT impulse response $h[n]$</li>
  <li>The response $y[n]$ when the input $x[n]$ is the DT unit step $u_0[n]$</li>
</ol>

<h3 id="51-the-transfer-function">5.1. The transfer function</h3>

<script type="math/tex; mode=display">H(z) = \frac{Y(z)}{U(z)} = ...?</script>

<pre style="border: 2px solid blue">



















</pre>

<h3 id="52-the-dt-impulse-response">5.2. The DT impulse response</h3>

<p>Start with:</p>

<script type="math/tex; mode=display">\frac{H(z)}{z} = \frac{z - 1}{z^2 + 0.5 z + 0.125}</script>

<pre style="border: 2px solid blue">



















</pre>

<h3 id="matlab-solution">Matlab Solution</h3>

<p>See <a href="matlab/dtm_ex1_2.mlx">dtm_ex1_2.mlx</a>. (Also available as <a href="matlab/dtm_ex1_2.m">dtm_ex1_2.m</a>.)</p>

<p>The difference equation describing the input-output relationship of the DT system with zero initial conditions, is:</p>

<script type="math/tex; mode=display">y[n] - 0.5 y[n-1] + 0.125 y[n-2] = x[n] + x[n -1]</script>

<h4 id="transfer-function">Transfer function</h4>

<p>Numerator $z + 1$</p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Nz</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">];</span>
</code></pre></div></div>

<p>Denominator $z^2 - 0.5 z + 0.125$</p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Dz</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="o">-</span><span class="mf">0.5</span> <span class="mf">0.125</span><span class="p">];</span>
</code></pre></div></div>

<h4 id="poles-and-residues">Poles and residues</h4>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">r</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">residue</span><span class="p">(</span><span class="n">Nz</span><span class="p">,</span><span class="n">Dz</span><span class="p">)</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>r =
   0.5000 - 2.5000i
   0.5000 + 2.5000i
p =
   0.2500 + 0.2500i
   0.2500 - 0.2500i
k =
     []

</code></pre></div></div>

<h4 id="impulse-response">Impulse Response</h4>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Hz</span> <span class="o">=</span> <span class="n">tf</span><span class="p">(</span><span class="n">Nz</span><span class="p">,</span><span class="n">Dz</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">hn</span> <span class="o">=</span> <span class="n">impulse</span><span class="p">(</span><span class="n">Hz</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Hz =
 
         z + 1
  -------------------
  z^2 - 0.5 z + 0.125
 
Sample time: 1 seconds
Discrete-time transfer function.


</code></pre></div></div>

<h4 id="plot-the-response">Plot the response</h4>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">stem</span><span class="p">([</span><span class="mi">0</span><span class="p">:</span><span class="mi">15</span><span class="p">],</span> <span class="n">hn</span><span class="p">)</span>
<span class="nb">grid</span>
<span class="nb">title</span><span class="p">(</span><span class="s1">'Example 5 - Part 2'</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s1">'n'</span><span class="p">)</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s1">'Impulse response h[n]'</span><span class="p">)</span>
</code></pre></div></div>

<p class="output output_png"><img src="../../images/dt_systems/4/dt_models_48_0.png" alt="png" /></p>

<h4 id="response-as-stepwise-continuous-yt">Response as stepwise continuous y(t)</h4>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">impulse</span><span class="p">(</span><span class="n">Hz</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="nb">grid</span>
<span class="nb">title</span><span class="p">(</span><span class="s1">'Example 5 - Part 2 - As Analogue Signal'</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s1">'nTs [s]'</span><span class="p">)</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s1">'Impulse response h(t)'</span><span class="p">)</span>
</code></pre></div></div>

<p class="output output_png"><img src="../../images/dt_systems/4/dt_models_50_0.png" alt="png" /></p>

<h3 id="53-the-dt-step-response">5.3. The DT step response</h3>

<script type="math/tex; mode=display">Y(z) = H(z)X(z)</script>

<script type="math/tex; mode=display">u_0[n] \Leftrightarrow \frac{z}{z - 1}</script>

<script type="math/tex; mode=display">% <![CDATA[
\begin{array}{lcl}
Y(z) = H(z){U_0}(z) &=& \frac{z^2 + z}{z^2 + 0.5z + 0.125}.\frac{z}{z - 1}\\
 & = & \frac{z(z^2 + z)}{(z^2 + 0.5z + 0.125)(z - 1)}
\end{array} %]]></script>

<script type="math/tex; mode=display">\frac{Y(z)}{z} = \frac{z^2 + z}{(z^2 + 0.5 z + 0.125)(z - 1)}</script>

<p>Solved by inverse Z-transform.</p>

<pre style="border: 2px solid blue">



















</pre>

<h3 id="matlab-solution-1">Matlab Solution</h3>

<p>See <a href="matlab/dtm_ex1_3.mlx">dtm_ex1_3.mlx</a>. (Also available as <a href="matlab/dtm_ex1_3.m">dtm_ex1_3.m</a>.)</p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">open</span> <span class="n">dtm_ex1_3</span>
</code></pre></div></div>

<h3 id="results">Results</h3>

<p><img src="pictures/dtm_ex1_3_1.png" /></p>

<h2 id="modelling-dt-systems-in-matlab-and-simulink">Modelling DT systems in Matlab and Simulink</h2>

<h3 id="matlab">Matlab</h3>

<p>Code extracted from <a href="matlab/dtm_ex1_3.m">dtm_ex1_3.m</a>:</p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Ts</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">tf</span><span class="p">(</span><span class="s1">'z'</span><span class="p">,</span> <span class="n">Ts</span><span class="p">)</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
z =
 
  z
 
Sample time: 1 seconds
Discrete-time transfer function.


</code></pre></div></div>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Hz</span> <span class="o">=</span> <span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="p">)/(</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">z</span> <span class="o">+</span> <span class="mf">0.125</span><span class="p">)</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Hz =
 
        z^2 + z
  -------------------
  z^2 - 0.5 z + 0.125
 
Sample time: 1 seconds
Discrete-time transfer function.


</code></pre></div></div>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">step</span><span class="p">(</span><span class="n">Hz</span><span class="p">)</span>
<span class="nb">grid</span>
<span class="nb">title</span><span class="p">(</span><span class="s1">'Example 1 - Part 3 - As Analogue Signal'</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s1">'nTs [s]'</span><span class="p">)</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s1">'Step response y(t)'</span><span class="p">)</span>
<span class="nb">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">3.5</span><span class="p">])</span>
</code></pre></div></div>

<p class="output output_png"><img src="../../images/dt_systems/4/dt_models_64_0.png" alt="png" /></p>

<h3 id="simulink-model">Simulink Model</h3>

<p>See <a href="matlab/dtm.slx">dtm.slx</a>:</p>

<p><img src="pictures/simulink_model.png" /></p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dtm</span>
</code></pre></div></div>

<h4 id="results-1">Results</h4>

<p><img src="pictures/scope.png" /></p>

<h2 id="converting-continuous-time-systems-to-discrete-time-systems">Converting Continuous Time Systems to Discrete Time Systems</h2>

<ul>
  <li>In analogue electronics, to implement a filter we would need to resort to op-amp circuits with resistors, capacitors and inductors acting as energy dissipation, storage and release devices.</li>
  <li>In modern digital electronics, it is often more convenient to take the original transfer function $H(s)$ and produce an equivalent $H(z)$.</li>
  <li>We can then determine a <em>difference equation</em> that will respresent $h[n]$ and implement this as <em>computer algorithm</em>.</li>
  <li>Simple storage of past values in memory becomes the repository of past state rather than the integrators and derivative circuits that are needed in the analogue world.</li>
  <li>To achieve this, all we need is to be able to do is to <em>sample</em> and <em>process</em> the signals quickly enough to avoid violating Nyquist-Shannon’s sampling theorem.</li>
</ul>

<h3 id="continuous-system-equivalents">Continuous System Equivalents</h3>

<ul>
  <li>There is no digital system that uniquely represents a continuous system</li>
  <li>This is because as we are sampling, we only have knowledge of signals being processed at the sampling instants, and need to <em>reconstruct</em> the inter-sample behaviour.</li>
  <li>In practice, only a small number of transformations are used.</li>
  <li>The derivation of these is beyond the scope of this module, but we’ll mention the ones that Matlab provides in a function called <code class="highlighter-rouge">c2d</code></li>
</ul>

<h3 id="matlab-c2d-function">Matlab c2d function</h3>

<p>Let’s see what the help function says:</p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">help</span> <span class="n">c2d</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code> C2D  Converts continuous-time dynamic system to discrete time.
 
    SYSD = C2D(SYSC,TS,METHOD) computes a discrete-time model SYSD with 
    sample time TS that approximates the continuous-time model SYSC.
    The string METHOD selects the discretization method among the following:
       'zoh'           Zero-order hold on the inputs
       'foh'           Linear interpolation of inputs
       'impulse'       Impulse-invariant discretization
       'tustin'        Bilinear (Tustin) approximation.
       'matched'       Matched pole-zero method (for SISO systems only).
       'least-squares' Least-squares minimization of the error between
                       frequency responses of the continuous and discrete 
                       systems (for SISO systems only).
    The default is 'zoh' when METHOD is omitted. The sample time TS should 
    be specified in the time units of SYSC (see "TimeUnit" property).
 
    C2D(SYSC,TS,OPTIONS) gives access to additional discretization options. 
    Use C2DOPTIONS to create and configure the option set OPTIONS. For 
    example, you can specify a prewarping frequency for the Tustin method by:
       opt = c2dOptions('Method','tustin','PrewarpFrequency',.5);
       sysd = c2d(sysc,.1,opt);
 
    For state-space models,
       [SYSD,G] = C2D(SYSC,Ts,METHOD)
    also returns the matrix G mapping the states xc(t) of SYSC to the states 
    xd[k] of SYSD:
       xd[k] = G * [xc(k*Ts) ; u[k]]
    Given an initial condition x0 for SYSC and an initial input value u0=u(0), 
    the equivalent initial condition for SYSD is (assuming u(t)=0 for t&lt;0):
       xd[0] = G * [x0;u0] .
 
    See also C2DOPTIONS, D2C, D2D, DYNAMICSYSTEM.

    Reference page in Doc Center
       doc c2d

    Other functions named c2d

       DynamicSystem/c2d    ltipack.tfdata/c2d


</code></pre></div></div>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">doc</span> <span class="n">c2d</span>
</code></pre></div></div>

<h3 id="example-6">Example 6</h3>

<ul>
  <li>Design a 2nd-order butterworth low-pass anti-aliasing filter with transfer function $H(s)$ for use in sampling music.</li>
  <li>The cut-off frequency $\omega_c = 20$ kHz and the filter should have an attenuation of at least $-80$ dB in the stop band.</li>
  <li>Choose a suitable sampling frequency for the audio signal and give the transfer function $H(z)$ and an algorithm to implement $h[n]$</li>
</ul>

<h3 id="solution">Solution</h3>

<p>See <a href="matlab/digit_butter.m">digit_butter.m</a>.</p>

<p>First determine the cut-off frequency $\omega_c$</p>

<script type="math/tex; mode=display">\omega_c = 2\pi f_c = 2\times \pi \times 20\times 10^3\;\mathrm{rad/s}</script>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">wc</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="mf">20e3</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wc =
   1.2566e+05

</code></pre></div></div>

<script type="math/tex; mode=display">\omega_c = 125.66\times 10^3\;\mathrm{rad/s}</script>

<p>From the lecture on filters, we know the 2nd-order butterworth filter has transfer function:</p>

<script type="math/tex; mode=display">H(s) = \frac{Y(s)}{U(s)} = \frac{\omega _c^2}{s^2 + \omega _c\sqrt 2 \,s + \omega _c^2}</script>

<p>Substituting for $\omega_c = 125.6637\times 10^3 $ this is …?</p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Hs</span> <span class="o">=</span> <span class="n">tf</span><span class="p">(</span><span class="n">wc</span><span class="o">^</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span> <span class="n">wc</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">wc</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Hs =
 
           1.579e10
  ---------------------------
  s^2 + 1.777e05 s + 1.579e10
 
Continuous-time transfer function.


</code></pre></div></div>

<script type="math/tex; mode=display">H(s) = \frac{15.79 \times 10^9}{s^2 + 177.7 \times 10^3 s + 15.79 \times 10^9}</script>

<h3 id="bode-plot">Bode plot</h3>

<p>Matlab:</p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">bode</span><span class="p">(</span><span class="n">Hs</span><span class="p">,{</span><span class="mf">1e4</span><span class="p">,</span><span class="mf">1e8</span><span class="p">})</span>
<span class="nb">grid</span>
</code></pre></div></div>

<p class="output output_png"><img src="../../images/dt_systems/4/dt_models_83_0.png" alt="png" /></p>

<h3 id="sampling-frequency">Sampling Frequency</h3>

<table>
  <tbody>
    <tr>
      <td>From the bode diagram, the frequency at which $</td>
      <td>H(j\omega)</td>
      <td>$ is $-80$ dB is approx $12.6\times 10^6$ rad/s.</td>
    </tr>
  </tbody>
</table>

<p>To avoid aliasing, we should choose a sampling frequency twice this = ?</p>

<p>$\omega_s = 2\times 12.6\times 10^6$ rad/s.</p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ws</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span> <span class="mf">12.6e6</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ws =
    25200000

</code></pre></div></div>

<p>So</p>

<p>$\omega_s = 25.2\times 10^6$ rad/s.</p>

<p>Sampling frequency ($f_s$) in Hz  = ?</p>

<script type="math/tex; mode=display">f_s = \omega_s/(2\pi)\;\mathrm{Mhz}</script>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fs</span> <span class="o">=</span> <span class="n">ws</span><span class="p">/(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="p">)</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fs =
   4.0107e+06

</code></pre></div></div>

<script type="math/tex; mode=display">f_s = 40.11\;\mathrm{Mhz}</script>

<p>Sampling time $T_s = ?$</p>

<p>$T_s = 1/fs\;\mathrm{s}$</p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Ts</span> <span class="o">=</span> <span class="mi">1</span><span class="p">/</span><span class="n">fs</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Ts =
   2.4933e-07

</code></pre></div></div>

<script type="math/tex; mode=display">T_s = 1/f_s \approx 0.25\;\mu\mathrm{s}</script>

<h3 id="digital-butterworth">Digital Butterworth</h3>

<p>zero-order-hold equivalent</p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Hz</span> <span class="o">=</span> <span class="n">c2d</span><span class="p">(</span><span class="n">Hs</span><span class="p">,</span> <span class="n">Ts</span><span class="p">)</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Hz =
 
  0.0004836 z + 0.0004765
  -----------------------
  z^2 - 1.956 z + 0.9567
 
Sample time: 2.4933e-07 seconds
Discrete-time transfer function.


</code></pre></div></div>

<h3 id="step-response">Step response</h3>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">step</span><span class="p">(</span><span class="n">Hz</span><span class="p">)</span>
</code></pre></div></div>

<p class="output output_png"><img src="../../images/dt_systems/4/dt_models_98_0.png" alt="png" /></p>

<h3 id="algorithm">Algorithm</h3>

<p>From previous result:</p>

<script type="math/tex; mode=display">H(z) = \frac{Y(z)}{U(z)} = \frac{486.6\times 10^{-6}z +  476.5\times 10^{-6}}{z^2 - 1.956z + 0.9567}</script>

<p>Dividing top and bottom by $z^2$ …</p>

<script type="math/tex; mode=display">H(z) = \frac{Y(z)}{U(z)} = \frac{486.6\times 10^{-6}z^{-1} +  476.5\times 10^{-6}z^{-2}}{1 - 1.956z^{-1} + 0.9567z^{-2}}</script>

<p>expanding out …</p>

<script type="math/tex; mode=display">\begin{array}{l}
Y(z) - 1.956{z^{ - 1}}Y(z) + 0.9567{z^{ - 2}}Y(z) = \\
\quad 486.6 \times {10^{ - 6}}{z^{ - 1}}U(z) + 476.5 \times {10^{ - 6}}{z^{ - 2}}U(z)
\end{array}</script>

<p>Inverse z-transform gives …</p>

<script type="math/tex; mode=display">\begin{array}{l}
y[n] - 1.956y[n - 1] + 0.9567y[n - 2] = \\
\quad 486.6 \times {10^{ - 6}}u[n - 1] + 476.5 \times {10^{ - 6}}u[n - 2]
\end{array}</script>

<p>in algorithmic form (compute $y[n]$ from past values of $u$ and $y$) …</p>

<script type="math/tex; mode=display">\begin{array}{l}
y[n] = 1.956y[n - 1] - 0.9567y[n - 2] + 486.6 \times {10^{ - 6}}u[n - 1] + ...\\
\quad 476.5 \times {10^{ - 6}}u[n - 2]
\end{array}</script>

<h3 id="convert-to-code">Convert to code</h3>

<p>To implement:
<script type="math/tex">y[n] = 1.956 y[n-1] - 0.9567 y[n - 2] + 486.6\times 10^{-6} u[n-1] + 476.5\times 10^{-6} u[n-2]</script></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/* Initialize */
Ts = 2.4933e-07; /* more probably some fraction of clock speed */
ynm1 = 0; ynm2 = 0; unm1 = 0; unm2 = 0;
while (true) {
    un = read_adc;
    yn = 1.956*ynm1 - 0.9567*ynm2 + 486.6e-6*unm1 + 476.5e-6*unm2;
    write_dac(yn);
    /* store past values */
    ynm2 = ynm1; ynm1 = yn;
    unm2 = unm1; unm1 = un;
    wait(Ts);
}
</code></pre></div></div>

<h3 id="comments">Comments</h3>

<p>PC soundcards can sample audio at 44.1 kHz so this implies that the anti-aliasing filter is much sharper than this one as $f_s/2 = 22.05$ kHz.</p>

<p>You might wish to find out what order butterworth filter would be needed to have $f_c = 20$ kHz and $f_{\mathrm{stop}}$ of 22.05 kHz.</p>

<h2 id="summary">Summary</h2>

<ul>
  <li>Discrete Time Systems</li>
  <li>Transfer Functions in the Z-Domain</li>
  <li>Modelling digital systems in Matlab/Simulink</li>
  <li>Continuous System Equivalents</li>
  <li>Example: Digital Butterworth Filter</li>
</ul>

<h2 id="solutions-to-example-5">Solutions to Example 5</h2>

<h3 id="solution-to-51">Solution to 5.1.</h3>

<p>The transfer function is</p>

<script type="math/tex; mode=display">H(z) = \frac{Y(z)}{X(z)} = \frac{z^2 + z}{z^2 - 0.5z + 0.125}</script>

<h3 id="solution-to-52">Solution to 5.2.</h3>

<p>The DT impulse response:</p>

<script type="math/tex; mode=display">h[n] = \left( \frac{\sqrt 2}{4} \right)^n{\left( \cos \left( \frac{n\pi}{4} \right) + 5\sin \left( \frac{n\pi}{4} \right) \right)}</script>

<h3 id="solution-to-53">Solution to 5.3.</h3>

<p>Step response:</p>

<script type="math/tex; mode=display">y[n] = \left(3.2 - \left( \frac{\sqrt 2}{4} \right)^n\left( 2.2 \cos \left( \frac{n\pi}{4} \right) + 0.6\sin \left(\frac{n\pi}{4} \right) \right)\right) u_0[n]</script>

              <nav class="c-page__nav">
  
    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/eg-247-textbook/dt_systems/3/i_z_transform">
      〈 <span class="u-margin-right-tiny"></span> The Inverse Z-Transform
    </a>
  

  
    <a id="js-page__nav__next" class="c-page__nav__next" href="/eg-247-textbook/worksheets/index">
      Worksheets <span class="u-margin-right-tiny"></span> 〉
    </a>
  
</nav>

            </div>
          </div>
        </div>
      </main>
    </div>

  </body>
</html>
