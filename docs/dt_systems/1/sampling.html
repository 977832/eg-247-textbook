<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>Sampling Theory</title>
  <meta name="description" content="cd matlabpwdformat compactclear all">

  <link rel="canonical" href="/eg-247-textbook/eg-247-textbook/dt_systems/1/sampling.html">
  <link rel="alternate" type="application/rss+xml" title="EG-247 Signals and Systems" href="/eg-247-textbook/eg-247-textbook/feed.xml">

  <meta property="og:url"         content="/eg-247-textbook/eg-247-textbook/dt_systems/1/sampling.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Sampling Theory" />
<meta property="og:description" content="cd matlabpwdformat compactclear all" />
<meta property="og:image"       content="" />


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage":
    "/eg-247-textbook/dt_systems/1/sampling.html",
  "headline":
    "Sampling Theory",
  "datePublished":
    "2019-02-21T11:48:52+00:00",
  "dateModified":
    "2019-02-21T11:48:52+00:00",
  "description":
    "cd matlabpwdformat compactclear all",
  "author": {
    "@type": "Person",
    "name": "Dr Chris P. Jobling"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "/eg-247-textbook",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "/eg-247-textbook",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/eg-247-textbook/assets/css/styles.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css ">
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/eg-247-textbook/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    CommonHTML: {
        linebreaks: {
            automatic: true,
        },
    },
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML' async></script>

  <!-- DOM updating function -->
  <script>
const runWhenDOMLoaded = cb => {
  if (document.readyState != 'loading') {
    cb()
  } else if (document.addEventListener) {
    document.addEventListener('DOMContentLoaded', cb)
  } else {
    document.attachEvent('onreadystatechange', function() {
      if (document.readyState == 'complete') cb()
    })
  }
}

// Helper function to init things quickly
initFunction = function(myfunc) {
  runWhenDOMLoaded(myfunc);
  document.addEventListener('turbolinks:load', myfunc);
};
</script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="/eg-247-textbook/assets/js/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  <script src="https://unpkg.com/nbinteract-core" async></script>

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->


  <!-- Google analytics -->
  <script src="/eg-247-textbook/assets/js/ga.js" async></script>

  <!-- Clipboard copy button -->
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" async></script>

  <!-- Load custom website scripts -->
  <script src="/eg-247-textbook/assets/js/scripts.js" async></script>

  <!-- Load JS that depends on site variables -->
  <script>
/**
 * Set up copy/paste for code blocks
 */
const codeCellId = index => `codecell${index}`

const clipboardButton = id =>
  `<a class="btn copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#${id}">
    <img src="/eg-247-textbook/assets/images/copy-button.svg" alt="Copy to clipboard">
  </a>`

// Clears selected text since ClipboardJS will select the text when copying
const clearSelection = () => {
  if (window.getSelection) {
    window.getSelection().removeAllRanges()
  } else if (document.selection) {
    document.selection.empty()
  }
}

// Changes tooltip text for two seconds, then changes it back
const temporarilyChangeTooltip = (el, newText) => {
  const oldText = el.getAttribute('data-tooltip')
  el.setAttribute('data-tooltip', newText)
  setTimeout(() => el.setAttribute('data-tooltip', oldText), 2000)
}

const addCopyButtonToCodeCells = () => {
  // If ClipboardJS hasn't loaded, wait a bit and try again. This
  // happens because we load ClipboardJS asynchronously.
  if (window.ClipboardJS === undefined) {
    setTimeout(addCopyButtonToCodeCells, 250)
    return
  }

  const codeCells = document.querySelectorAll('.input_area pre')
  codeCells.forEach((codeCell, index) => {
    const id = codeCellId(index)
    codeCell.setAttribute('id', id)
    codeCell.insertAdjacentHTML('afterend', clipboardButton(id))
  })

  const clipboard = new ClipboardJS('.copybtn')
  clipboard.on('success', event => {
    clearSelection()
    temporarilyChangeTooltip(event.trigger, 'Copied!')
  })

  clipboard.on('error', event => {
    temporarilyChangeTooltip(event.trigger, 'Failed to copy')
  })

  // Get rid of clipboard before the next page visit to avoid memory leak
  document.addEventListener('turbolinks:before-visit', () =>
    clipboard.destroy()
  )
}

initFunction(addCopyButtonToCodeCells);
</script>

  <!-- Load custom user CSS and JS  -->
  <script src="/eg-247-textbook/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/eg-247-textbook/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  <script>
/**
  * To auto-embed hub URLs in interact links if given in a RESTful fashion
 */

function getJsonFromUrl(url) {
  var query = url.split('?');
  if (query.length < 2) {
    // No queries so just return false
    return false;
  }
  query = query[1];
  // Collect REST params into a dictionary
  var result = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  });
  return result;
}
    
function dict2param(dict) {
    params = Object.keys(dict).map(function(k) {
        return encodeURIComponent(k) + '=' + encodeURIComponent(dict[k])
    });
    return params.join('&')
}

// Parse a Binder URL, converting it to the string needed for JupyterHub
function binder2Jupyterhub(url) {
  newUrl = {};
  parts = url.split('v2/gh/')[1];
  // Grab the base repo information
  repoinfo = parts.split('?')[0];
  var [org, repo, ref] = repoinfo.split('/');
  newUrl['repo'] = ['https://github.com', org, repo].join('/');
  newUrl['branch'] = ref
  // Grab extra parameters passed
  params = getJsonFromUrl(url);
  if (params['filepath'] !== undefined) {
    newUrl['subPath'] = params['filepath']
  }
  return dict2param(newUrl);
}

// Filter out potentially unsafe characters to prevent xss
function safeUrl(url)
{
   return String(encodeURIComponent(url))
            .replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
}

function addParamToInternalLinks(hub) {
  var links = document.querySelectorAll("a").forEach(function(link) {
    var href = link.href;
    // If the link is an internal link...
    if (href.search("") !== -1 || href.startsWith('/') || href.search("127.0.0.1:") !== -1) {
      // Assume we're an internal link, add the hub param to it
      var params = getJsonFromUrl(href);
      if (params !== false) {
        // We have REST params, so append a new one
        params['hub'] = hub;
      } else {
        // Create the REST params
        params = {'hub': hub};
      }
      // Update the link
      var newHref = href.split('?')[0] + '?' + dict2param(params);
      link.setAttribute('href', decodeURIComponent(newHref));
    }
  });
  return false;
}

// Update interact links
function updateInteractLink() {
    // hack to make this work since it expects a ? in the URL
    rest = getJsonFromUrl("?" + location.search.substr(1));
    hubUrl = rest['hub'];
    if (hubUrl !== undefined) {
      // Sanitize the hubUrl
      hubUrl = safeUrl(hubUrl);
      // Add HTTP text if omitted
      if (hubUrl.indexOf('http') < 0) {hubUrl = 'http://' + hubUrl;}
      link = document.querySelectorAll("a.interact-button")[0];
      if (link !== undefined) {
          // Update the interact link URL
          var href = link.getAttribute('href');
          var hub_type = '';
          if (hub_type === 'binder') {
            // If binder links exist, we need to re-work them for jupyterhub
            if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
              // If localhost, assume we're working from a local Jupyter server and remove `/hub`
              first = [hubUrl, 'git-sync'].join('/')
            } else {
              first = [hubUrl, 'hub', 'user-redirect', 'git-sync'].join('/')
            }
            href = first + '?' + binder2Jupyterhub(href);
          } else {
            // If JupyterHub links, we only need to replace the hub url
            href = href.replace("", hubUrl);
            if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
              // Assume we're working from a local Jupyter server and remove `/hub`
              href = href.replace("/hub/user-redirect", "");
            }
          }
          link.setAttribute('href', decodeURIComponent(href));

          // Add text after interact link saying where we're launching
          hubUrlNoHttp = decodeURIComponent(hubUrl).replace('http://', '').replace('https://', '');
          document.querySelectorAll("a.interact-button")[0].insertAdjacentHTML('afterend', '<div class="interact-context">on ' + hubUrlNoHttp + '</div>');
      }
      // Update internal links so we retain the hub url
      addParamToInternalLinks(hubUrl);
    }
}

runWhenDOMLoaded(updateInteractLink)
document.addEventListener('turbolinks:load', updateInteractLink)
</script>
</head>

  <body>
    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <img src="/eg-247-textbook/images/logo/logo.png" class="textbook_logo" id="sidebar-logo" data-turbolinks-permanent/>
  <h2 class="c-sidebar__title">EG-247 Signals and Systems</h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/introduction/index"
        >
          
            1.
          
          Introduction
        </a>

        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/elementary_signals/index"
        >
          
            2.
          
          Elementary Signals
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/elementary_signals/hw1"
                >
                  
                  Homework 1
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/laplace_transform/index"
        >
          
            3.
          
          Laplace Transforms and their Applications
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/1/laplace"
                >
                  
                    3.1
                  
                  The Laplace Transformation
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/2/inverse_laplace"
                >
                  
                    3.2
                  
                  The Inverse Laplace Transform
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/3/circuit_analysis"
                >
                  
                    3.3
                  
                  Using Laplace Transforms for Circuit Analysis
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/4/transfer_functions"
                >
                  
                    3.4
                  
                  Transfer Functions
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/5/convolution"
                >
                  
                    3.5
                  
                  The Impulse Response and Convolution
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/fourier_series/index"
        >
          
            4.
          
          Fourier Series
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_series/1/trig_fseries"
                >
                  
                    4.1
                  
                  Trigonometric Fourier Series
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_series/2/exp_fs1"
                >
                  
                    4.2
                  
                  Exponential Fourier Series
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_series/3/exp_fs2"
                >
                  
                    4.3
                  
                  Line Spectra and their Applications
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/fourier_transform/index"
        >
          
            5.
          
          Fourier Transform
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_transform/1/ft1"
                >
                  
                    5.1
                  
                  Defining the Fourier Transform
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_transform/2/ft2"
                >
                  
                    5.2
                  
                  Fourier transform of commonly occuring signals
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_transform/3/ft3"
                >
                  
                    5.3
                  
                  Fourier Transforms for Circuit and LTI Systems Analysis
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_transform/4/ft4"
                >
                  
                    5.4
                  
                  Introduction to Filters
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/dt_systems/index"
        >
          
            6.
          
          Sampled Data Systems
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry c-sidebar__entry--active"
                  href="/eg-247-textbook/dt_systems/1/sampling"
                >
                  
                    6.1
                  
                  Sampling Theory
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/dt_systems/2/z_transform"
                >
                  
                    6.2
                  
                  The Z-Transform
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/dt_systems/3/i_z_transform"
                >
                  
                    6.3
                  
                  The Inverse Z-Transform
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/dt_systems/4/dt_models"
                >
                  
                    6.4
                  
                  Models of Discrete Time Systems
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      
        <li><h2 class="c-sidebar__title">In Class Worksheets</li>
        
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/worksheets/index"
        >
          
          Worksheets
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/introduction/worksheet1"
                >
                  
                  Worksheet 1 Introduction
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/introduction/worksheet2"
                >
                  
                  Worksheet 2
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/elementary_signals/worksheet3"
                >
                  
                  Worksheet 3 Elementary Signals
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/1/worksheet4"
                >
                  
                  Worksheet 4 Laplace Transform
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/2/worksheet5"
                >
                  
                  Worksheet 5 Inverse Laplace Transform
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/3/worksheet6"
                >
                  
                  Worksheet 6 Using Laplace Transforms for Circuit Analysis
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/4/worksheet7"
                >
                  
                  Worksheet 7 Transfer Functions
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      
        <li><h2 class="c-sidebar__title">Homework</li>
        
      
      
        <li class="c-sidebar__divider"></li>
        
      
      
        <li><h2 class="c-sidebar__title">Lab Exercises</li>
        
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/labs/index"
        >
          
          Laboratory Exercises
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/lab01/index"
                >
                  
                  Lab 1 - Elemementary Signals
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/lab02/index"
                >
                  
                  Lab 2 - Laplace and Inverse Laplace Transforms
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/lab03/index"
                >
                  
                  Lab 3 -  Laplace Transforms and Transfer Functions for Circuit Analysis
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/lab04/index"
                >
                  
                  Lab 4 - Time Domain Convolution
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/lab05/index"
                >
                  
                  Lab 5 - Fourier Series
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/lab06/index"
                >
                  
                  Lab 6 - Sounds and Sampling
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/lab07/index"
                >
                  
                  Optional Lab 7 - Filters
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/project/index"
                >
                  
                  Project
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      
        <li><h2 class="c-sidebar__title">Project</li>
        
      
      
        <li class="c-sidebar__divider"></li>
        
      
      
        <li><h2 class="c-sidebar__title">Answers to Selected problems</li>
        
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/introduction/answers"
        >
          
          Worksheet 2
        </a>

        
      </li>

      
    
  </ul>
  <p class="sidebar_footer">Powered by <a href="https://github.com/choldgraf/jupyter-book">Jupyter Book</a></p>
</nav>

      <!-- Shamelessly copied from minimal mistakes -->


<!-- TOC will only show up if it has at least one item -->


  <aside class="sidebar__right">
    <nav class="onthispage">
      <header><h4 class="nav__title"><i class="fa fa-list"></i>   On this page</h4></header>
      <ul class="toc__menu">
  <li><a href="#scope-and-background-reading">Scope and Background Reading</a></li>
  <li><a href="#agenda">Agenda</a></li>
  <li><a href="#acknowledgements">Acknowledgements</a></li>
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#a-real-example">A Real Example</a>
    <ul>
      <li><a href="#technical-details">Technical Details</a></li>
      <li><a href="#question">Question</a></li>
    </ul>
  </li>
  <li><a href="#sampling-ct-signals">Sampling CT Signals</a>
    <ul>
      <li><a href="#time-domain">Time domain</a></li>
      <li><a href="#frequency-domain">Frequency domain</a></li>
      <li><a href="#the-mathematics">The Mathematics</a></li>
      <li><a href="#nyquist-shannon-sampling-theorem">Nyquist-Shannon Sampling Theorem</a></li>
      <li><a href="#recovery-of-signal-by-filtering">Recovery of signal by filtering</a></li>
      <li><a href="#ideal-lowpass-filter-for-ct-recovery-from-dt-sampled-signal">Ideal Lowpass Filter for CT Recovery from DT Sampled Signal</a></li>
      <li><a href="#sample-and-hold">Sample-and-hold</a></li>
      <li><a href="#sample-and-hold-operator">Sample-and-hold operator</a></li>
    </ul>
  </li>
  <li><a href="#matlab-example">Matlab example</a>
    <ul>
      <li><a href="#define-a-suitable-signal">Define a suitable signal</a></li>
      <li><a href="#notes">Notes</a></li>
    </ul>
  </li>
  <li><a href="#signal-reconstruction">Signal Reconstruction</a>
    <ul>
      <li><a href="#perfect-signal-interpolation-using-sinc-functions">Perfect Signal Interpolation Using sinc Functions</a></li>
    </ul>
  </li>
  <li><a href="#aliasing">Aliasing</a>
    <ul>
      <li><a href="#an-aliased-signal">An Aliased Signal</a></li>
      <li><a href="#example-1">Example 1</a></li>
      <li><a href="#example-2">Example 2</a></li>
      <li><a href="#antialising-filters">Antialising Filters</a></li>
      <li><a href="#example-3">Example 3</a></li>
      <li><a href="#practical-application---digital-audio">Practical application - digital audio</a></li>
    </ul>
  </li>
  <li><a href="#dt-processing-of-ct-signals">DT Processing of CT Signals</a></li>
  <li><a href="#sampling-of-dt-signals">Sampling of DT Signals</a></li>
  <li><a href="#summary">Summary</a>
    <ul>
      <li><a href="#answer-to-question">Answer to Question</a></li>
    </ul>
  </li>
  <li><a href="#matlab-functions-used">Matlab Functions used</a></li>
</ul>
    </nav>
  </aside>



      <main class="c-textbook__page" tabindex="-1">
          <div class="o-wrapper">
            <div class="c-sidebar-toggle">
  <!-- We show the sidebar by default so we use .is-active -->
  <button
    id="js-sidebar-toggle"
    class="hamburger hamburger--arrowalt is-active"
  >
    <span class="hamburger-box">
      <span class="hamburger-inner"></span>
    </span>
    <span class="c-sidebar-toggle__label">Toggle Sidebar</span>
  </button>
</div>

            
<div class="buttons">




</div>


            <div class="c-textbook__content">
              <div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> <span class="n">matlab</span>
<span class="nb">pwd</span>
<span class="nb">format</span> <span class="n">compact</span>
<span class="nb">clear</span> <span class="nb">all</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
ans =

    '/Users/eechris/dev/eg-247-textbook/content/dt_systems/1/matlab'


</code></pre></div></div>

<h1 id="sampling-systems">Sampling Systems</h1>

<h2 id="scope-and-background-reading">Scope and Background Reading</h2>

<p>This session is an introduction to sampling theory. It reviews the important ideas that pertain to sampling but leaves the detailed mathematics for your further study.</p>

<p>The material in this presentation and notes is based on Chapter 15 of <a href="http://site.ebrary.com/lib/swansea/docDetail.action?docID=10228195">Benoit Boulet, Fundamentals of Signals and Systems</a> from the <strong>Recommended Reading List</strong> and you’ll find the mathematical treatments there. There is much more detail in Chapter 9 of <a href="http://site.ebrary.com/lib/swansea/docDetail.action?docID=10547416">Steven T. Karris, Signals and Systems: with Matlab Computation and Simulink Modelling, 5th Edition</a> from the <strong>Required Reading List</strong>.</p>

<h2 id="agenda">Agenda</h2>

<ul>
  <li>
    <p>Sampling of Continuous-Time Signals</p>
  </li>
  <li>
    <p>Signal Reconstruction</p>
  </li>
  <li>
    <p>Discrete-time Processing of Continuous-Time Signals</p>
  </li>
  <li>
    <p>Sampling of Discrete-Time Systems</p>
  </li>
</ul>

<h2 id="acknowledgements">Acknowledgements</h2>

<p>We will be using an adaptation of a pair of demo scripts to illustrate <em>alialising</em>. These scripts were published by Prof. Charles A. Bouman, School of Electrical and Computer Engineering, Purdue University as part of the course materials for <a href="https://engineering.purdue.edu/VISE/ee438/demos/">ECE438: Digital Signal Processing</a>.</p>

<h2 id="introduction">Introduction</h2>

<ul>
  <li>The <em>sampling process</em> provides the bridge between continuous-time (CT) and discrete-time (DT) signals</li>
  <li>Sampling records discrete values of a CT signal at periodic instants of time.</li>
  <li>Sampled data can be used in <em>real-time</em> or <em>off-line</em> processing</li>
  <li>Sampling opens up possibility of processing CT signals through <em>finite impulse response</em> (FIR) and <em>infinite impulse response</em> (IIR) filters.</li>
</ul>

<h2 id="a-real-example">A Real Example</h2>

<p>I need a volunteer to provide a sound sample ….</p>

<ol>
  <li>I will use this <a href="https://uk.mathworks.com/help/matlab/matlab_prog/what-is-a-live-script-or-function.html">Live Script</a> <a href="matlab/sampling_demo.mlx">sampling_demo.mlx</a> to sample your voice.</li>
  <li>I will then playback the recording.</li>
  <li>I will the plot the data.</li>
</ol>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">open</span> <span class="n">sampling_demo</span>
</code></pre></div></div>

<h3 id="technical-details">Technical Details</h3>

<ul>
  <li><strong>Sampling rate</strong>: 8000 samples per second (fs = 8 kHz)</li>
  <li><strong>Resolution</strong>: 8 bits per sample</li>
  <li><strong>Channels</strong>: 1 channel.</li>
  <li><strong>Reconstruction</strong>: Matlab plays the audio back at 8192 samples per second.</li>
</ul>

<h3 id="question">Question</h3>

<p>What will the bit-rate be for playback?</p>

<pre style="border: 2px solid blue">





</pre>

<h2 id="sampling-ct-signals">Sampling CT Signals</h2>

<p>What is going on here?</p>

<h3 id="time-domain">Time domain</h3>

<p>Sampling can be modelled as the multiplication of a continuous-time signal by a sequence of periodic impulses as illustrated here.</p>

<p><img src="pictures/sampling.png" /></p>

<p>This is a form of <strong>modulation</strong></p>

<p>$T_s$ is the period of the periodic sampling function.</p>

<h3 id="frequency-domain">Frequency domain</h3>

<p>Multiplication in time domain is <em>convolution</em> in the frequency domain</p>

<p><img src="pictures/sampling_fr.png" /></p>

<p>$\omega_s$ is the frequency of the periodic sampling function = $2\pi/T_s$.</p>

<h3 id="the-mathematics">The Mathematics</h3>

<p><strong>The Sampled signal</strong>:</p>

<script type="math/tex; mode=display">{x_s}(t) = \sum\limits_{k =  - \infty }^{ + \infty } {x(k{T_s})\delta (t - k{T_s})}</script>

<p><strong>Frequency convolution</strong>:
<script type="math/tex">{X_s}(\omega ) = \frac{1}{T_s}\int_{ - \infty }^{ + \infty } {X(\upsilon )} \sum\limits_{k =  - \infty }^{ + \infty } {\delta (t - \upsilon  - k{\omega _s})} \,d\upsilon</script></p>

<p><strong>Sampling property</strong>:</p>

<script type="math/tex; mode=display">{X_s}(\omega ) = \frac{1}{T_s}\int_{ - \infty }^{ + \infty } {\sum\limits_{k =  - \infty }^{ + \infty } {X(\omega  - k{\omega _s})} } \delta (t - \upsilon  - k{\omega _s})\,d\upsilon</script>

<p><strong>Sifting property</strong>:</p>

<script type="math/tex; mode=display">{X_s}(\omega ) = \frac{1}{T_s}\sum\limits_{n =  - \infty }^{ + \infty } {X(\omega  - k{\omega _s})}</script>

<h3 id="nyquist-shannon-sampling-theorem">Nyquist-Shannon Sampling Theorem</h3>

<p>Gives a sufficient condition to recover a continuous time signal from its samples $x(nT_s)$, $n$ is an integer.</p>

<p><strong>Sampling Theoreom</strong></p>

<table>
  <tbody>
    <tr>
      <td>Let $x(t)$ be a band-limited signal with $X(\omega) = 0$ for $</td>
      <td>\omega</td>
      <td>&gt;\omega_M$.</td>
    </tr>
  </tbody>
</table>

<p>Then $x(t)$ is uniquely determined by its samples $x(nT_s)$, $\infty &lt;n &lt; +\infty$ if</p>

<script type="math/tex; mode=display">\omega_s > 2\omega_M,</script>

<p>where $\omega_s = 2\pi/T_s$ is the sampling frequency.</p>

<h3 id="recovery-of-signal-by-filtering">Recovery of signal by filtering</h3>

<p><img src="pictures/recovery.png" /></p>

<p><img src="pictures/recovered.png" /></p>

<h3 id="ideal-lowpass-filter-for-ct-recovery-from-dt-sampled-signal">Ideal Lowpass Filter for CT Recovery from DT Sampled Signal</h3>

<p><img src="pictures/recover-lp.png" /></p>

<p>This is of course theoretical only!</p>

<h3 id="sample-and-hold">Sample-and-hold</h3>

<p><img src="pictures/sandh.png" /></p>

<h3 id="sample-and-hold-operator">Sample-and-hold operator</h3>

<p><img src="pictures/zoh.png" /></p>

<h2 id="matlab-example">Matlab example</h2>

<p>Basic set up</p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">clear</span> <span class="nb">all</span>
<span class="n">w0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>        <span class="c1">% fundamental frequency rad/s</span>
<span class="n">t0</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="p">/</span><span class="n">w0</span><span class="p">;</span>    <span class="c1">% period s</span>
<span class="n">tmax</span> <span class="o">=</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">t0</span><span class="p">;</span> <span class="c1">% plotable range</span>
</code></pre></div></div>

<h3 id="define-a-suitable-signal">Define a suitable signal</h3>
<p>We will use a system with an underdamped second-order response.</p>

<p>The transfer function is:
<script type="math/tex">H(s) = \frac{\omega_0^2}{s^2 + 2\zeta\omega_0 s + \omega_0^2}</script></p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">syms</span> <span class="n">s</span> <span class="n">t</span>
<span class="n">zeta</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">;</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">w0</span><span class="o">^</span><span class="mi">2</span><span class="p">/(</span><span class="n">s</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">zeta</span><span class="o">*</span><span class="n">w0</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="n">w0</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>H =
1/(s^2 + (3*s)/5 + 1)

</code></pre></div></div>

<h4 id="calculate-and-plot-impulse-response">Calculate and plot impulse response</h4>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">h</span> <span class="o">=</span> <span class="n">ilaplace</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
</code></pre></div></div>

<div class="output output_stream highlighter-rouge"><div class="highlight"><pre class="highlight"><code>h =
(10*91^(1/2)*exp(-(3*t)/10)*sin((91^(1/2)*t)/10))/91

</code></pre></div></div>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">t</span> <span class="o">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">tmax</span><span class="p">,</span><span class="mi">100</span><span class="p">);</span>
<span class="n">xc</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">h</span><span class="p">);</span> <span class="c1">% eval evaluates a symbolic expression as a Matlab command.</span>
<span class="n">tc</span> <span class="o">=</span> <span class="n">t</span><span class="p">;</span>
</code></pre></div></div>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">plot</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span><span class="n">xc</span><span class="p">)</span>
<span class="nb">title</span><span class="p">(</span><span class="s1">'Fig 1: Continuous Time Signal x(t)'</span><span class="p">)</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s1">'x(t)'</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s1">'Time t [s]'</span><span class="p">)</span>
</code></pre></div></div>

<p class="output output_png"><img src="../../images/dt_systems/1/sampling_36_0.png" alt="png" /></p>

<p>You can generate all the images in this presentation by running the Matlab script: <a href="sampling.m">sampling.m</a> which is also available as a Live Script <a href="matlab/sampling.mlx">sampling.mlx</a>.</p>

<h4 id="calculate-and-plot-sampled-data">Calculate and plot sampled data</h4>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ws</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">w0</span><span class="p">;</span> <span class="c1">% twice minimum!</span>
<span class="n">Ts</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="p">)/</span><span class="n">ws</span><span class="p">;</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">:</span><span class="n">Ts</span><span class="p">:</span><span class="n">tmax</span><span class="p">;</span>
<span class="n">xs</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">h</span><span class="p">);</span>
<span class="n">td</span> <span class="o">=</span> <span class="n">t</span><span class="p">;</span>
</code></pre></div></div>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">stem</span><span class="p">(</span><span class="n">td</span><span class="p">,</span><span class="n">xs</span><span class="p">)</span>
<span class="nb">hold</span> <span class="n">on</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span><span class="n">xc</span><span class="p">,</span><span class="s1">'r:'</span><span class="p">)</span>
<span class="nb">hold</span> <span class="n">off</span>
<span class="nb">title</span><span class="p">(</span><span class="s1">'Fig 2: Sampled Signal x_s(t)'</span><span class="p">)</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s1">'x_s(t)'</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s1">'Time t [s]'</span><span class="p">)</span>
</code></pre></div></div>

<p class="output output_png"><img src="../../images/dt_systems/1/sampling_40_0.png" alt="png" /></p>

<h3 id="notes">Notes</h3>

<p>The sampled signal $x_0(t)$ carries the same information as the samples themselves, so we should be able to recover the entire signal $x(t)$.</p>

<p>From the block diagram of the sample-and-hold operator, what we would need to do is find the inverse of the ZOH system with impulse response $h_0(t)$ and then use a perfect lowpass filter.</p>

<p>The frequency response $H_0(\omega)$ is given by the usual sinc function for an even rectangular pulse signal, multiplied by $e^{-j\omega T_s/2}$ because we need a time delay of $T_s/2$ to make the signal causal:</p>

<script type="math/tex; mode=display">{H_0}(\omega ) = {T_s}{e^{ - j\omega {T_s}/2}}\frac{\sin \left( {\pi \frac{T_s}{2\pi }\omega } \right)}{\pi \frac{T_s}{2\pi}\omega } = 2{e^{ - j\omega {T_s}/2}}\frac{\sin \left( {\omega {T_s}/2} \right)}{\omega }</script>

<p>The inverse of $H_0(\omega)$ is given by</p>

<script type="math/tex; mode=display">{H_1}(\omega ) = {H^{ - 1}}(\omega ) = \frac{1}{2}{e^{j\omega \frac{T_s}{2}}}\frac{\omega }{\sin \left( {\frac{T_s}{2}\omega } \right)}</script>

<p>The <em>reconstruction filter</em> is the cascade of the inverse filter and the lowpass filter:</p>

<script type="math/tex; mode=display">H_r(\omega)=T_sH_{\mathrm{lp}}(\omega)H_1(\omega)</script>

<p><img src="pictures/reconstruction_filter.png" /></p>

<p>The frequency response of this filter and additional notes are to be found on Page 546 of Boulet.</p>

<h2 id="signal-reconstruction">Signal Reconstruction</h2>

<p><strong>Problem</strong></p>

<ul>
  <li>We have a bandlimited signal that is sampled at the Nyquist-Shannon sampling frequency $\omega_s = 2\pi/T_s$.</li>
  <li>We therefore have a discrete-time (DT) signal $x(nT_s)$ from which we want to reconstruct the original signal.</li>
</ul>

<h3 id="perfect-signal-interpolation-using-sinc-functions">Perfect Signal Interpolation Using sinc Functions</h3>

<ul>
  <li>
    <p>In the <em>frequency domain</em>, the ideal way to reconstruct the signal would be to construct a chain of impulses $x_s(t)$ and then to filter this signal with an ideal lowpass filter.</p>
  </li>
  <li>
    <p>In the <em>time domain</em>, this is equivalent to interpolating the samples using time-shifted sinc functions with zeros at $nT_s$ for $\omega_c = \omega_s$.</p>
  </li>
</ul>

<p>Signal reconstructed with sinc function</p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">stem</span><span class="p">(</span><span class="n">td</span><span class="p">,</span><span class="n">xs</span><span class="p">)</span>
<span class="nb">hold</span> <span class="n">on</span>
<span class="n">x</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">td</span><span class="p">),</span><span class="nb">length</span><span class="p">(</span><span class="n">tc</span><span class="p">));</span>
<span class="k">for</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">td</span><span class="p">)</span>
    <span class="n">xk</span> <span class="o">=</span> <span class="n">xs</span><span class="p">(</span><span class="n">k</span><span class="p">);</span>
    <span class="n">sincx</span> <span class="o">=</span> <span class="n">xk</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">tc</span> <span class="o">-</span> <span class="n">td</span><span class="p">(</span><span class="n">k</span><span class="p">))/</span><span class="n">Ts</span><span class="p">)</span><span class="o">.</span><span class="p">/(</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">tc</span> <span class="o">-</span> <span class="n">td</span><span class="p">(</span><span class="n">k</span><span class="p">))/</span><span class="n">Ts</span><span class="p">);</span>
    <span class="n">x</span><span class="p">(</span><span class="n">k</span><span class="p">,:)</span> <span class="o">=</span> <span class="n">sincx</span><span class="p">;</span>
<span class="k">end</span>
</code></pre></div></div>

<p class="output output_png"><img src="../../images/dt_systems/1/sampling_45_0.png" alt="png" /></p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">plot</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="s1">'-.'</span><span class="p">)</span>
<span class="nb">hold</span> <span class="n">off</span>
<span class="nb">title</span><span class="p">(</span><span class="s1">'Fig 5: Signal x(t) reconstructed with sinc functions'</span><span class="p">)</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s1">'x(t)'</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s1">'Time t [s]'</span><span class="p">)</span>
</code></pre></div></div>

<p class="output output_png"><img src="../../images/dt_systems/1/sampling_46_0.png" alt="png" /></p>

<p>Each impulse in $x_s(t)$ triggers the impulse reponse of the lowpass filter (the sinc signal), the resulting signal $x(t)$ at the output of the filter is the sum of all these time-shifted sinc signals with amplitudes equal to the samples $x(nT_s)$.</p>

<script type="math/tex; mode=display">x(t) = \sum\limits_{k =  - \infty }^{ + \infty } {x(n{T_s}){\rm{sinc}}} \left( {\frac{t - n{T_s}}{T_s}} \right)</script>

<p>(Note we have defined ${\rm{sinc}}(x)$ as $\sin(\pi x)/(\pi x)$.)</p>

<h4 id="reconstructed-signal">Reconstructed signal</h4>
<p>Obtained by summing all the sinc functions</p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">plot</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">tc</span><span class="p">,</span><span class="n">xc</span><span class="p">,</span><span class="s1">'r:'</span><span class="p">)</span>
<span class="nb">title</span><span class="p">(</span><span class="s1">'Fig 6: Reconstruction with sinc functions'</span><span class="p">)</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s1">'x(t)'</span><span class="p">)</span>
</code></pre></div></div>

<p class="output output_png"><img src="../../images/dt_systems/1/sampling_49_0.png" alt="png" /></p>

<p>This is clearly unfeasible, at least in real-time, so we have to resort to approximations of the ideal low-pass filter.</p>

<p>A couple of examples are given below. Boulet gives more information including an evaluation of the quality of the approximation.</p>

<p>In practice, the zero-order-hold is often used in practice and a low-pass filter with a flat passband (such as the Butterworth filter discussed in the last lecture) would be used. In audio applications, for example, the low-pass nature of speakers and the human ear add additional smoothing. For non HiFi applications (e.g. an MP3 player), this may be all that is actually used!</p>

<h4 id="signal-reconstructed-with-zero-order-hold-zoh">Signal reconstructed with zero-order hold (ZOH)</h4>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">stairs</span><span class="p">(</span><span class="n">td</span><span class="p">,</span><span class="n">xs</span><span class="p">)</span>
<span class="nb">hold</span> <span class="n">on</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span><span class="n">xc</span><span class="p">,</span><span class="s1">'r:'</span><span class="p">)</span>
<span class="nb">title</span><span class="p">(</span><span class="s1">'Fig 3: Signal x(t) reconstructed with zero-order-hold'</span><span class="p">)</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s1">'x(t)'</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s1">'Time t [s]'</span><span class="p">)</span>
</code></pre></div></div>

<p class="output output_png"><img src="../../images/dt_systems/1/sampling_52_0.png" alt="png" /></p>

<h4 id="signal-reconstructed-with-first-order-hold-foh">Signal reconstructed with First-order hold (FOH)</h4>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">plot</span><span class="p">(</span><span class="n">td</span><span class="p">,</span><span class="n">xs</span><span class="p">,</span><span class="s1">'bo-'</span><span class="p">,</span><span class="n">tc</span><span class="p">,</span><span class="n">xc</span><span class="p">,</span><span class="s1">'r:'</span><span class="p">)</span>
<span class="nb">title</span><span class="p">(</span><span class="s1">'Fig 4: Signal x(t) reconstructed with first-order-hold'</span><span class="p">)</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s1">'x(t)'</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s1">'Time t [s]'</span><span class="p">)</span>
</code></pre></div></div>

<p class="output output_png"><img src="../../images/dt_systems/1/sampling_54_0.png" alt="png" /></p>

<h2 id="aliasing">Aliasing</h2>

<ul>
  <li>
    <p>Aliasing Occurs when the sampling frequency is too low to ovoid overlapping between the spectra.</p>
  </li>
  <li>
    <p>When aliasing occours, we have violated the sampling theorem: that is $\omega_s &lt; 2\omega_m$.</p>
  </li>
  <li>
    <p>When aliasing occurs, the original signal cannot be recovered by lowpass filtering.</p>
  </li>
</ul>

<h3 id="an-aliased-signal">An Aliased Signal</h3>

<p><img src="pictures/aliasing.png" /></p>

<h3 id="example-1">Example 1</h3>

<p>We use the recording made at the start and run it through a script that effectively aliases the original signal be reducing the sampling frequency to less than half the original sampling frequency.</p>

<p>Here’s the script: <a href="aliaseg1.mlx">aliaseg1.mlx</a> that I’ll be using. (Also available as an m-file <a href="aliaseg1.m">aliaseg1.m</a>)</p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">open</span> <span class="n">aliaseg1</span>
</code></pre></div></div>

<h3 id="example-2">Example 2</h3>

<p>Assume signal $x(t)=\cos(\omega_0 t)$ is sampled at a rate of $\omega_s = 1.5\omega_0$, violating the sampling theorem.</p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">open</span> <span class="n">aliasing</span>
</code></pre></div></div>

<p>We can see the effect on the plot below:</p>

<p><img src="pictures/aliasing_ex.png" /></p>

<p>Image generated by <a href="aliasing.mlx">aliasing.mlx</a> (Also available as <a href="aliasing.m">aliasing.m</a>).</p>

<p>You should confirm for yourself that after lowpass filtering the spectrum with a filter with cutofff frequency $\omega_c = \omega_s/2$ that the signal returned is the spectrum of $x(t)=\cos(\omega_0 t/2)$</p>

<h3 id="antialising-filters">Antialising Filters</h3>

<ul>
  <li>
    <p>Most real signals are not band-limited so we have to artificially make them bandlimited  using an <em>anti-aliasing filter</em>.</p>
  </li>
  <li>
    <p>An anti-aliasing filter is a low-pass filter whose cutoff frequency is lower than half the sampling frequency.</p>
  </li>
  <li>
    <p>This can produce some distortion at high-frequencies but this is often better than the distortion that would occur at low frequencies if aliasing was allowed to happen.</p>
  </li>
  <li>
    <p>For more on this topic see Pages 551—552 of Boulet.</p>
  </li>
</ul>

<h3 id="example-3">Example 3</h3>

<p>This example uses anti-aliasing to downsample the audio. You should hear that the sound is less distorted as we sample below the sampling frequency of 8 kHz.</p>

<p>Script: <a href="aliaseg2.mlx">aliaseg2.mlx</a> (Also available as an m-file <a href="aliaseg2.m">aliaseg2.m</a>)</p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">open</span> <span class="n">aliaseg2</span>
</code></pre></div></div>

<h3 id="practical-application---digital-audio">Practical application - digital audio</h3>

<p>Human beings can hear sounds with frequencies up to around 20 kHz so when recording music in the modern sound studio (or phone or PC for that matter) the audio signal is antialiased with a 22 kHz filter. The signal is then sampled at 44.1 kHz before being stored for later processing and/or playback.</p>

<h2 id="dt-processing-of-ct-signals">DT Processing of CT Signals</h2>

<p><img src="pictures/ct-to-dt.png" /></p>

<p>The concepts presented in this session provide a model that allows us to cross the bridge between the theoretical concept of impulse chain sampling through to a representation of a signal as discrete sequence $x[n]$ (to be introduced next lecture) and back to a continuous-time signal via reconstruction.</p>

<p>The mathematics predicts the nature of the signals that are processed in the ideal case, but we will leave it with you to study these for yourself. (See Boulet pp 552—557).</p>

<p>In practice, modern digital processing relies on the use of an analogue-to-digital converter (ADC) (which also introduces amplitude quantization), finite-length arithmetic inside the discrete-time system (usually a microprocessor, microcontroller or digital signal processor), followed by conversion back to a step-wise continuous signal via a digital to analogue converter (DAC) that operates like a zero-order-hold.</p>

<h2 id="sampling-of-dt-signals">Sampling of DT Signals</h2>

<ul>
  <li>
    <p>In modern signal processing and digital communications many of the operations that were once done in continuous time are now done entirely in discrete time.</p>
  </li>
  <li>
    <p>For example, we can implement sampling and modulation in discrete time.</p>
  </li>
  <li>
    <p>We can also upsample (interpolate between samples) or downsample (reduce the number of samples in a discrete-time signal)</p>
  </li>
</ul>

<p>These topics are left to you for further study.</p>

<h2 id="summary">Summary</h2>

<ul>
  <li>Sampling of Continuous-Time Signals</li>
  <li>Signal Reconstruction</li>
  <li>Discrete-time Processing of Continuous-Time Signals</li>
  <li>Sampling of Discrete-Time Systems</li>
</ul>

<p><em>Next session</em></p>

<ul>
  <li>The Z-Transform</li>
</ul>

<h3 id="answer-to-question">Answer to Question</h3>

<p>bit rate = [number of samples per second] x [number of bits per sample] x [number of channels]</p>

<p>bit rate = $8192 \times 8 \times 1$ bits/second [baud]</p>

<p>bit rate = $65,536$ bits/second</p>

<h2 id="matlab-functions-used">Matlab Functions used</h2>

<ul>
  <li>The matlab recorder command is: <code class="highlighter-rouge">recorder = audiorecorder(Fs,nBits,nChannels);</code></li>
  <li>Sound is recorded using: <code class="highlighter-rouge">recordblocking(recObj, time);</code></li>
  <li>Recorded sound is played back: <code class="highlighter-rouge">play(recorder);</code></li>
  <li>Sound is extracted as Matlab data using: <code class="highlighter-rouge">x = getaudiodata(recorder);</code></li>
  <li>Sound is plotted against sample number using: <code class="highlighter-rouge">plot(x)</code></li>
  <li>I extracted 50 points for the stem plot using <code class="highlighter-rouge">stem([1000:1049],myRecording(1000:1049))</code></li>
  <li>Sound is saved as an audio file using: <code class="highlighter-rouge">audiowrite(audioFile,myRecording,Fs);</code> where <code class="highlighter-rouge">audiofile</code> is a filename in form <code class="highlighter-rouge">name.extension</code>. Supported extensions are <code class="highlighter-rouge">'.wav'</code>, <code class="highlighter-rouge">'.ogg'</code>, and <code class="highlighter-rouge">'.flac'</code> on all platforms. Windows and Mac support <code class="highlighter-rouge">'.m4m'</code> and ‘<code class="highlighter-rouge">.mp4</code>’.</li>
  <li>Sound is loaded using <code class="highlighter-rouge">[x,Fs]=audioread(audioFile);</code>. Additional file formats are supported for reading including <code class="highlighter-rouge">'.mp3'</code>.</li>
  <li>Frequency response spectra were generated using the fast Fourier transform (<code class="highlighter-rouge">fft</code>) function.</li>
  <li>Multiple graphs in one figure window is achieved using <code class="highlighter-rouge">subplot</code>.</li>
</ul>

<p>For more information use <code class="highlighter-rouge">doc</code> <em>command</em> from the command-line.</p>


              <nav class="c-page__nav">
  
    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/eg-247-textbook/dt_systems/index">
      〈 <span class="u-margin-right-tiny"></span> Sampled Data Systems
    </a>
  

  
    <a id="js-page__nav__next" class="c-page__nav__next" href="/eg-247-textbook/dt_systems/2/z_transform">
      The Z-Transform <span class="u-margin-right-tiny"></span> 〉
    </a>
  
</nav>

            </div>
          </div>
        </div>
      </main>
    </div>

  </body>
</html>
